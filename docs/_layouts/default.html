<!DOCTYPE html>
<html lang="{{ site.lang | default: " en-US" }}">

<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}"
        media="screen" type="text/css">
    <link rel="stylesheet" href="{{ '/assets/css/print.css' | relative_url }}" media="print" type="text/css">

    {% seo %}

    {% include head-custom.html %}
</head>

<body>
    <header>
        <div class="inner">
            <a href="{{ '/' | absolute_url }}">
                <h1>{{ site.title | default: site.github.repository_name }}</h1>
            </a>
            <h2>{{ site.description | default: site.github.project_tagline }}</h2>
            {% if site.github.is_project_page %}
            <a href="{{ site.github.repository_url }}" class="button"><small>View project on</small> GitHub</a>
            {% endif %}
            {% if site.github.is_user_page %}
            <a href="{{ site.github.owner_url }}" class="button"><small>Follow me on</small> GitHub</a>
            {% endif %}
        </div>
    </header>

    <div id="content-wrapper">
        <div class="inner clearfix">
            <section id="main-content">
                {{ content }}
            </section>

            <aside id="sidebar">

                <details id="toc" open>
                    <summary class="toc-title">目次</summary>
                </details>


            </aside>
        </div>
    </div>

    <script>
        (function(window, document) {
          const toc = document.getElementById('toc');

          const selector = document.querySelectorAll; // 処理対象セレクタ
          if (!toc || !selector) {
            return
          }

          const list = document.createElement('ul');
          list.className = 'toc-container';
          toc.appendChild(list);
        
          const headings = selector.querySelectorAll('h2, h3, h4'); // 対象見出しタグ
          const order = [];
          const stack = [{level: 1, element: list}];
        
          // 事前処理
          headings.forEach((heading) => {
            const level = parseInt(heading.tagName.substring(1))
            order.push(level);
          });
        
          headings.forEach((heading, i) => {
            const level = parseInt(heading.tagName.substring(1));
            const next = order[i + 1];
            const li = document.createElement('li');
            const a = document.createElement('a');
            const id = 'toc-' + (i + 1);
            const ul = document.createElement('ul');
        
            // 目次要素の生成
            a.textContent = heading.textContent;
            a.href = `#${id}`;
            li.appendChild(a);
            if (level < next) {
              li.appendChild(ul);
            }
        
            // リンク先の生成
            heading.id = id;
        
            // 階層構造の生成
            let parent;
            do {
              parent = stack.pop();
            } while (parent.level >= level);
            parent.element.appendChild(li);
            stack.push(parent);
            stack.push({level: level, element: ul});
          });
        }(window, document));
        </script>

</body>

</html>